Fluent:Notify({
        Title = "Script",
        Content = "Soon function and gameüòÑ",
        SubContent = "SubContent", -- Optional
        Duration = 5 -- Set to nil to make the notification not disappear
    })

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Phantom Hub " .. Fluent.Version,
    SubTitle = "by cakein228",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true, -- The blur may be detectable, setting this to false disables blur entirely
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl -- Used when theres no MinimizeKeybind
})

local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" }),
    Soon = Window:AddTab({ Title = "Soon More", Icon = "Sing" })
}

local Toggle = Tabs.Main:AddToggle("AutoFarm", {Title = "Auto Farm", Default = false })

Toggle:OnChanged(function()
    _G.AutoFarm = Toggle.Value
    print("Auto Farm toggled:", Toggle.Value)
end)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local workspace = game:GetService("Workspace")

_G.AutoFarm = false
_G.Speed = 23

local movingToCoin, currentCoin = false, nil
local coinStartTime = nil

local function isCharacterValid()
    return LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
end

local function hasValidCoinVisual(coin)
    local coinVisual = coin:FindFirstChild("CoinVisual")
    return coinVisual and coinVisual.Transparency == 0
end

local function getNearestCoin()
    local nearest, minDist = nil, math.huge
    for _, coin in ipairs(workspace:GetDescendants()) do
        if coin.Name == "Coin_Server" and coin:IsA("Part") and hasValidCoinVisual(coin) then 
            local dist = (coin.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
            if dist < minDist then
                nearest, minDist = coin, dist
            end
        end
    end
    return nearest
end

local function teleportToCoin(coin)
    if not isCharacterValid() then return end
    LocalPlayer.Character.HumanoidRootPart.CFrame = coin.CFrame
end

local function moveToCoin(coin)
    if not isCharacterValid() then return end
    local rootPart = LocalPlayer.Character.HumanoidRootPart
    local distance = (coin.Position - rootPart.Position).Magnitude

    if distance > 250 then
        teleportToCoin(coin)
        movingToCoin = false
        return
    end

    if not hasValidCoinVisual(coin) then
        movingToCoin = false
        return
    end

    if os.clock() - coinStartTime > 10 then
        teleportToCoin(coin)
        movingToCoin = false
        return
    end

    local direction = (coin.Position - rootPart.Position).unit
    if distance > 3 then
        rootPart.CFrame = CFrame.new(rootPart.Position, coin.Position) * CFrame.Angles(math.rad(90), 0, 0)
        rootPart.CFrame = rootPart.CFrame + direction * _G.Speed * RunService.Heartbeat:Wait()
    else
        movingToCoin = false
    end
end

RunService.Heartbeat:Connect(function()
    if not _G.AutoFarm or not isCharacterValid() then return end

    if not movingToCoin then
        currentCoin = getNearestCoin()
        if currentCoin then
            movingToCoin = true
            coinStartTime = os.clock()
        end
    elseif currentCoin then
        moveToCoin(currentCoin)
    end
end)

local AntiFlingToggle = Tabs.Settings:AddToggle("AntiFling", { Title = "Anti Fling", Default = true})
local AntiFlingEnabled = false

AntiFlingToggle:OnChanged(function(Value)
    AntiFlingEnabled = Value
    print("AntiFling toggled:", Value)
end)

-- –§—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–Ω—É–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
local function SafeNeutralizeVelocity(part)
    if part:IsA("BasePart") then
        part.AssemblyAngularVelocity = Vector3.zero
        part.AssemblyLinearVelocity = Vector3.zero
        part.CanCollide = false
        part.CustomPhysicalProperties = PhysicalProperties.new(0, 0, 0, 0, 0)
    end
end

-- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏–≥—Ä–æ–∫–∞
local function MonitorLocalPlayer()
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local LocalPlayer = Players.LocalPlayer

    local function onCharacterAdded(character)
        local PrimaryPart = character:WaitForChild("HumanoidRootPart", 5)
        local LastSafePosition = nil

        RunService.Heartbeat:Connect(function()
            if not AntiFlingEnabled or not PrimaryPart then return end

            -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
            if PrimaryPart.AssemblyLinearVelocity.Magnitude > 150 or PrimaryPart.AssemblyAngularVelocity.Magnitude > 150 then
                SafeNeutralizeVelocity(PrimaryPart)

                -- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
                if LastSafePosition then
                    PrimaryPart.CFrame = LastSafePosition
                end

                -- –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π —á–∞—Ç
                game.StarterGui:SetCore("ChatMakeSystemMessage", {
                    Text = "Excessive velocity detected! Stabilizing...",
                    Color = Color3.fromRGB(255, 0, 0),
                })
            else
                LastSafePosition = PrimaryPart.CFrame
            end
        end)
    end

    -- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫ —Å–æ–±—ã—Ç–∏—è–º
    LocalPlayer.CharacterAdded:Connect(onCharacterAdded)
    if LocalPlayer.Character then
        onCharacterAdded(LocalPlayer.Character)
    end
end

-- –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–Ω—Ç–∏–æ—Ç–∫–∏–¥—ã–≤–∞–Ω–∏—è
MonitorLocalPlayer()

-- Toggle for enabling AFK mode
local Toggle = Tabs.Settings:AddToggle("AutoAFK", {Title = "Enable Auto AFK", Default = true})

Toggle:OnChanged(function()
    if Toggle.Value then
        -- –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ-AFK —Å–∫—Ä–∏–ø—Ç, –µ—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∫–ª—é—á–µ–Ω
        local player = game.Players.LocalPlayer

        local function stayAFK()
            while true do
                wait(300)  -- –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
                game:GetService("VirtualUser"):CaptureController()
                game:GetService("VirtualUser"):ClickButton2(Vector2.new())
            end
        end

        -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ—Å–ø–∞—É–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        player.CharacterAdded:Connect(function(character)
            stayAFK()  -- –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è
        end)

        -- –ó–∞–ø—É—Å–∫–∞–µ–º —Å—Ä–∞–∑—É, –µ—Å–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if player.Character then
            stayAFK()
        end
    else
        print("Auto AFK disabled")
    end
end)

Tabs.Soon:AddButton({
    Title = "–ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
    Callback = function()
        Fluent:Notify({
            Title = "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
            Content = "–≠—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–∑ Phantom Hub!",
            Duration = 5, -- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            Type = "Info" -- –¢–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: "Info", "Warning", "Error", "Success"
        })
    end
})
